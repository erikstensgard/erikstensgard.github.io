// Function to create the table with OMJSON data
function createOMTable(selectedData) {
  const table = document.createElement('table');
  table.classList.add('table');

  const tbody = document.createElement('tbody');

  const { Contents } = selectedData;
  const maxRow = Math.max(...Contents.map(item => item.Row));
  const columns = Math.max(...Contents.map(item => item.Column));

  for (let row = 1; row <= maxRow; row++) {
    const bodyRow = document.createElement('tr');

    for (let column = 1; column <= columns; column++) {
      const matchingItems = Contents.filter(
        item => item.Row === row && item.Column === column
      );

      const displayCell = document.createElement('td');

      if (matchingItems.length > 0) {
        matchingItems.forEach(matchingItem => {
          const { Text, Item, Header, DisplayText } = matchingItem;
          let cellContent = Text || '';

          if (cellContent === '' && DisplayText) {
            cellContent = DisplayText;
          } else if (cellContent === '' && Item) {
            cellContent = Item;
          }

          const cellContentElement = document.createElement('div');

          // Check if cellContent consists only of underscore characters
          if (/^_+$/.test(cellContent)) {
            cellContentElement.textContent = cellContent;
          } else {
            cellContentElement.textContent = cellContent;

            if (Header === 1) {
              cellContentElement.classList.add('bold');
            }

            // Add the CSS class for bolded items
            if (Header === 1) {
              displayCell.classList.add('bold');
            }

            if (Item) {
              cellContentElement.classList.add('clickable');
              cellContentElement.addEventListener('click', () => {
                handleRowClick(matchingItem);
              });
            }
          }

          displayCell.appendChild(cellContentElement);
        });
      }

      bodyRow.appendChild(displayCell);
    }

    tbody.appendChild(bodyRow);
  }

  table.appendChild(tbody);

  const resultContainer = document.getElementById('resultContainer');
  resultContainer.innerHTML = '';
  if (selectedData) {
    resultContainer.appendChild(table);
  }
}
