<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JSON Test</title>
  <style>
    /* Common styles */
    table {
      border-collapse: collapse;
      padding: 0; /* Reduce table padding */
    }

    th,
    td {
      border: none;
      padding: 4px; /* Reduce cell padding */
    }

    .clickable {
      color: blue;
      cursor: pointer;
    }

    .bold {
      font-weight: bold;
      background-color: lightblue; /* Set your desired background color here */
    }

    /* Header styles */
    #header {
      position: sticky;
      top: 0;
      background-color: white;
      z-index: 1;
    }

    /* Table styles */
    .table {
      table-layout: fixed;
      width: 100%;
    }

    .table td {
      white-space: nowrap; /* Disable text wrapping within a cell */
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Media queries for responsive design */
    @media screen and (max-width: 768px) {
      /* Adjust table font size for smaller screens */
      .table td {
        font-size: 11px;
      }

      /* Adjust button and dropdown font size for smaller screens */
      button,
      select {
        font-size: 11px;
      }
    }

    @media screen and (max-width: 480px) {
      /* Further adjust table font size for even smaller screens */
      .table td {
        font-size: 8px;
      }

      /* Further adjust button and dropdown font size for even smaller screens */
      button,
      select {
        font-size: 8px;
      }
    }

  </style>

</head>

<body>
  <div id="header">
    <button id="goBackButton">&larr; Go Back</button>
    <button id="mainMenuButton">Main Menu</button>
    <button id="goForwardButton">Go Forward &rarr;</button>
    <select id="filterDropdown"></select>
  </div>

  <div id="resultContainer">
    <table id="resultTable" class="table">
      <thead>
        <tr>
          <th>Attribute</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody id="resultBody"></tbody>
    </table>
  </div>

  <script>
    // Global variables
    let omData = []; // OMJSON data
    let odData = []; // ODJSON data
    let selectedData = null; // Currently selected data
    let history = []; // History of selected items
    let forwardHistory = []; // History of forward selections
    let historyIndex = -1; // Index of the current selection in the history

    // Fetch OMJSON data
    function fetchOMData() {
      return fetch('omjson.json')
        .then(response => response.json())
        .catch(error => {
          console.error('Error fetching OMJSON data:', error);
        });
    }

    // Fetch ODJSON data
    function fetchODData() {
      return fetch('odjson.json')
        .then(response => response.json())
        .catch(error => {
          console.error('Error fetching ODJSON data:', error);
        });
    }

    // Function to filter data based on the selected item
    function filterData(event) {
      const selectedItem = event.target.value;
      const omItem = omData.find(item => item.Name === selectedItem);
      const odItem = odData.find(item => item.Name === selectedItem);

      selectedData = omItem || odItem;

      // Push the current selection to history
      pushHistory(selectedItem);

      // Update the table
      updateTable();
    }

    // Function to update the table with the selected data
    function updateTable() {
      const tableBody = document.getElementById('resultBody');
      tableBody.innerHTML = '';

      if (selectedData) {
        Object.entries(selectedData).forEach(([key, value]) => {
          const row = document.createElement('tr');
          const attributeCell = document.createElement('td');
          const valueCell = document.createElement('td');

          attributeCell.textContent = key;
          valueCell.textContent = value;

          row.appendChild(attributeCell);
          row.appendChild(valueCell);
          tableBody.appendChild(row);
        });
      }
    }

    // Function to populate the dropdown with data
    function populateDropdown(data) {
      const dropdown = document.getElementById('filterDropdown');
      dropdown.innerHTML = '';

      data.sort((a, b) => a.Name.localeCompare(b.Name)); // Sort data alphabetically

      data.forEach(item => {
        const option = document.createElement('option');
        option.value = item.Name;
        option.textContent = item.DisplayText || item.Name;
        dropdown.appendChild(option);
      });
    }

    // Function to push the current selection to the history
    function pushHistory(item) {
      if (item !== history[historyIndex]) {
        historyIndex++;
        history.splice(historyIndex, history.length - historyIndex, item);
        forwardHistory = [];
      }
    }

    // Function to handle the Go Back button click event
    function handleGoBack() {
      if (historyIndex > 0) {
        historyIndex--;
        const selectedItem = history[historyIndex];
        const dropdown = document.getElementById('filterDropdown');
        dropdown.value = selectedItem;
        filterData({ target: dropdown });
      }
    }

    // Function to handle the Go Forward button click event
    function handleGoForward() {
      if (historyIndex < history.length - 1) {
        historyIndex++;
        const selectedItem = history[historyIndex];
        const dropdown = document.getElementById('filterDropdown');
        dropdown.value = selectedItem;
        filterData({ target: dropdown });
      }
    }

    // Function to handle the Main Menu button click event
    function handleMainMenu() {
      // Reset all variables and clear history
      selectedData = null;
      history = [];
      forwardHistory = [];
      historyIndex = -1;

      // Clear the dropdown selection
      const dropdown = document.getElementById('filterDropdown');
      dropdown.selectedIndex = 0;

      // Clear the table
      updateTable();
    }

    // Event listeners for button clicks
    document.getElementById('goBackButton').addEventListener('click', handleGoBack);
    document.getElementById('goForwardButton').addEventListener('click', handleGoForward);
    document.getElementById('mainMenuButton').addEventListener('click', handleMainMenu);
    document.getElementById('filterDropdown').addEventListener('change', filterData);

    // Initial setup
    Promise.all([fetchOMData(), fetchODData()])
      .then(([omJson, odJson]) => {
        omData = omJson;
        odData = odJson;

        const mergedData = [...omData, ...odData];
        populateDropdown(mergedData);
      })
      .catch(error => {
        console.error('Error:', error);
      });
  </script>
</body>

</html>
